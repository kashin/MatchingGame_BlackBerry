var facesNumber = 5;
var imgSrcUrl = 'local:///assets/images/smile.png';
var leftSide;
var rightSide;
var bodyElement;

function init() {
  console.error('init is called');
  leftSide = document.getElementById('leftGameSide');
  rightSide = document.getElementById('rightGameSide');
  bodyElement = document.getElementsByTagName('body')[0];
  regenerateSmiles();
}

function clearAllChildNodes(element) {
  while(element.firstChild) {
    element.removeChild(element.firstChild);
  }
}

function regenerateSmiles() {
  clearAllChildNodes(leftSide);
  clearAllChildNodes(rightSide);
  var imgElement;
  for (var i = 0; i < facesNumber; i++) {
    imgElement = document.createElement('img');
    imgElement.src = imgSrcUrl;
    imgElement.style.position = 'absolute';
    imgElement.style.top = Math.floor(Math.random() * (leftSide.offsetHeight - 80)) + 'px';
    imgElement.style.left = Math.floor(Math.random() * (leftSide.offsetWidth - 81)) +
                            'px'; // -81 because 80 px for img size + 1 for border size.
    leftSide.appendChild(imgElement);
  }
  imagesElement = leftSide.cloneNode(true);
  imagesElement.id = '';
  imagesElement.classList.remove('left');
  imagesElement.classList.remove('game-panel');
  imagesElement.removeChild(imagesElement.lastChild);
  rightSide.appendChild(imagesElement);
  leftSide.lastChild.onclick = function correctFaceClicked(event){
    event.stopPropagation();
    facesNumber += 5;
    regenerateSmiles();
  };
  bodyElement.onclick = function gameOver() {
    alert("Game Over! New game will be automatically started in 5 seconds");
    setTimeout(regenerateSmiles, 5000);
    facesNumber = 5;
    bodyElement.onclick = null;
    leftSide.lastChild.onclick = null;
  }; 
}


